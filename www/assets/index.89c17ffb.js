import{_ as H,a as Z,j as x,k as ee,l as te,m as ae,f as q,h as F,n as oe}from"./index.da4ff793.js";import{u as K}from"./useI18n.25a437e0.js";import{d as X,r as h,e as le,q as d,t as p,y as z,k as t,x as a,S as k,R as v,F as G,X as J,v as f,z as C,c as ne,a as se,f as re,a3 as ue,a4 as N,D as T,M as $,n as Q}from"./ant-design-vue.27440fdb.js";import{T as de,f as W}from"./validate.f7694c3d.js";import{u as ie}from"./useDrawer.8b3a90cf.js";import{g as Y}from"./dictFormat.31da75fc.js";var me="/assets/close.450593be.svg",pe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:me}),ce="/assets/exitFullScreen.1d9e4126.svg",ve=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:ce}),fe="/assets/fullScreen.1a03daf4.svg",ge=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:fe}),be="/assets/language.2331f79f.svg",_e=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:be}),he="/assets/nav-approvalManagement.ca478867.svg",ye=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:he}),Se="/assets/nav-baseInfo.6e90abb7.svg",ke=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Se}),Ce="/assets/nav-finance.7b46882b.svg",Te=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Ce}),Ie="/assets/nav-home.a3e6b3f3.svg",Me=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Ie}),je="/assets/nav-sys.c9d2f242.svg",we=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:je}),Oe="/assets/nav-system.e82f1343.svg",Fe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Oe}),ze="/assets/search.c02878dc.svg",Ne=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:ze}),$e="/assets/setting.3836908b.svg",Ue=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:$e}),Ae="/assets/tabs-left.6cd9927a.svg",Ee=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Ae}),Re="/assets/tabs-right.88c47129.svg",De=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Re});const Be={"../../icons/close.svg":pe,"../../icons/exitFullScreen.svg":ve,"../../icons/fullScreen.svg":ge,"../../icons/language.svg":_e,"../../icons/nav-approvalManagement.svg":ye,"../../icons/nav-baseInfo.svg":ke,"../../icons/nav-finance.svg":Te,"../../icons/nav-home.svg":Me,"../../icons/nav-sys.svg":we,"../../icons/nav-system.svg":Fe,"../../icons/search.svg":Ne,"../../icons/setting.svg":Ue,"../../icons/tabs-left.svg":Ee,"../../icons/tabs-right.svg":De},Pe=Object.keys(Be).map(e=>e.replace(/(.*\/)*([^.]+).*/,"$2")),Ve=X({props:{value:{type:String,required:!0},placeholder:{type:String}},emits:["change"],setup(e,{emit:n}){const{t:I}=K(),g=h(e.value),w=h(e.placeholder),b=s=>{n("change",s)};return le(()=>{g.value=e.value}),{t:I,icons:Pe,iconPlaceholder:w,selected:g,handleChange:b,reset:()=>{g.value=""}}}}),qe={class:"flex items-center"},Le={class:"flex items-center"},He={class:"mr-2"};function Ke(e,n,I,g,w,b){const c=d("svg-icon"),s=d("a-select-option"),M=d("a-select");return p(),z("div",qe,[t(M,{value:e.selected,"onUpdate:value":n[0]||(n[0]=m=>e.selected=m),style:{width:"100%"},placeholder:e.iconPlaceholder||e.t("common.resetText"),"option-label-prop":"label",onChange:e.handleChange},{suffixIcon:a(()=>[t(c,{name:e.selected,size:"12"},null,8,["name"])]),default:a(()=>[t(s,{value:"",label:e.t("common.nothing")},{default:a(()=>[k(v(e.t("common.nothing")),1)]),_:1},8,["label"]),(p(!0),z(G,null,J(e.icons,m=>(p(),f(s,{value:m,label:m,key:m},{default:a(()=>[C("div",Le,[C("span",He,v(m),1),t(c,{name:m},null,8,["name"])])]),_:2},1032,["value","label"]))),128))]),_:1},8,["value","placeholder","onChange"])])}var Xe=H(Ve,[["render",Ke]]);const{t:r}=K(),Ge=[{title:r("routes.menu.title"),dataIndex:"title",key:"title"},{title:r("routes.menu.icon"),dataIndex:"icon",key:"icon",align:"center",slots:{customRender:"icon"}},{title:r("routes.menu.orderNum"),dataIndex:"orderNum",key:"orderNum",align:"center"},{title:r("routes.menu.perms"),dataIndex:"perms",key:"perms",align:"center"},{title:r("routes.menu.component"),dataIndex:"component",key:"component",align:"center"},{title:r("routes.menu.status"),dataIndex:"status",key:"status",align:"center",slots:{customRender:"status"}},{title:r("routes.menu.visible"),dataIndex:"visible",key:"visible",align:"center",slots:{customRender:"visible"}},{title:r("routes.menu.createdAt"),dataIndex:"createdAt",key:"createdAt",align:"center"},{title:r("routes.menu.action"),key:"action",align:"center",slots:{customRender:"action"}}],Je=X({components:{IconSelect:Xe,Treeselect:de},setup(){const e=ne(()=>Z().loading),n=h([]),I=h([]),g=h(),w=h(Object.keys(x)),b=h(),c=o=>({id:o.id,label:o.title,children:o.children}),s=h([{id:0,title:r("routes.menu.homeDirectory"),children:[]}]),M=h([]),m=()=>{q().then(o=>{M.value=F(o.data.rows,"id","parentId").tree,s.value[0].children=F(o.data.rows,"id").tree})},i=se({id:void 0,parentId:void 0,menuType:"M",icon:void 0,title:void 0,orderNum:"1",path:void 0,component:void 0,perms:void 0,visible:"1",status:"1",keepAlive:1,isFrame:"0"}),U=(o,y)=>i.menuType==="M"&&typeof y=="string"&&y.charAt(0)!=="/"?Promise.reject(r("routes.menu.menuTypeRule")):Promise.resolve(),A={parentId:[{required:!0,validator:W.number,message:r("routes.menu.parentIdCannotBeEmpty"),trigger:"change"}],title:[{required:!0,message:r("routes.menu.titleCannotBeEmpty"),trigger:"blur"}],orderNum:[{required:!0,validator:W.number,message:r("routes.menu.orderNumCannotBeEmpty"),trigger:"blur"}],path:[{required:!0,message:r("routes.menu.pathCannotBeEmpty"),trigger:"blur"},{validator:U,trigger:"blur"}],component:[{required:!0,message:r("routes.menu.componentCannotBeEmpty"),trigger:"blur"}],perms:[{required:!0,message:r("routes.menu.permsCannotBeEmpty"),trigger:"blur"}]},{open:u,drawerTitle:_}=ie(),O=()=>{i.id=void 0,b.value.resetFields(),u.value=!1},E=()=>{b.value.validate().then(()=>{i.id?ee(i).then(o=>{$.success(o.message),m(),i.id=void 0,b.value.resetFields(),u.value=!1}):te(i).then(o=>{$.success(o.message),m(),i.id=void 0,b.value.resetFields(),u.value=!1})}).catch(o=>{console.log("error",o)})},R=o=>{ae(o.id).then(()=>{m(),$.success(r("common.deleteSuccess"))})},D=o=>{console.log(o),$.success(r("common.cancelDelete"))},B=o=>{q().then(y=>{y.data.rows.forEach(S=>{S.isDisabled=!1}),s.value[0].children=F(y.data.rows,"id").tree,u.value=!0,_.value=r("common.add"),o!=null&&o.id&&Q(()=>{i.parentId=o.id,g.value.forest.selectedNodeIds.push(o.id)})})},P=o=>{q().then(y=>{y.data.rows.forEach(S=>{S.id===o.id?S.isDisabled=!0:S.isDisabled=!1}),s.value[0].children=F(y.data.rows,"id").tree,oe(o.id).then(S=>{u.value=!0,_.value=r("common.update"),Q(()=>{Object.keys(i).forEach(L=>{i[L]=S.data[L]}),g.value.forest.selectedNodeIds.push(S.data.parentId)})})})},V=o=>{i.icon=o},j=o=>{i.parentId=o.id},l=()=>{m()};return re(async()=>{n.value=await Y("sys_normal_disable"),I.value=await Y("sys_show_hide"),n.value.forEach(o=>{o.label=o.dictLabel,o.value=o.dictValue}),I.value.forEach(o=>{o.label=o.dictLabel,o.value=o.dictValue}),l()}),{t:r,loading:e,menuList:M,confirm:R,cancel:D,columns:Ge,handleAdd:B,handleUpdate:P,open:u,drawerTitle:_,handleClose:O,handleSubmit:E,formState:i,dynamicComponents:w,labelCol:{span:6},wrapperCol:{span:18},normalizer:c,treeOptions:s,rules:A,formRef:b,handleIconChange:V,treeRef:g,handleTreeSelect:j,disableOptions:n,showOrHideOptions:I}}}),Qe={class:"p-4"},We={class:"flex justify-center"},Ye={class:"flex justify-center"},Ze={class:"flex justify-center"};function xe(e,n,I,g,w,b){const c=d("a-button"),s=d("a-col"),M=d("a-row"),m=d("svg-icon"),i=d("a-popconfirm"),U=d("a-table"),A=d("treeselect"),u=d("a-form-item"),_=d("a-radio-group"),O=d("a-input"),E=d("IconSelect"),R=d("a-input-number"),D=d("a-select-option"),B=d("a-select"),P=d("a-form"),V=d("a-drawer"),j=ue("has-permi");return p(),z("div",Qe,[t(M,{gutter:10,class:"mb-2"},{default:a(()=>[N(t(s,null,{default:a(()=>[t(c,{color:"success",onClick:e.handleAdd},{default:a(()=>[k(v(e.t("common.add")),1)]),_:1},8,["onClick"])]),_:1},512),[[j,["system:menu:add"]]])]),_:1}),t(U,{loading:e.loading,rowKey:"id",columns:e.columns,"data-source":e.menuList,defaultExpandAllRows:!0,pagination:!1},{icon:a(({record:l})=>[C("div",We,[t(m,{name:l.icon},null,8,["name"])])]),status:a(({record:l})=>[C("div",Ye,[C("span",null,v(l.status==="1"?e.t("common.normal"):e.t("common.deactivate")),1)])]),visible:a(({record:l})=>[C("div",Ze,[C("span",null,v(l.visible==="1"?e.t("common.show"):e.t("common.hidden")),1)])]),action:a(({record:l})=>[C("span",null,[N(t(c,{type:"link",color:"success",class:"mr-3",onClick:o=>e.handleAdd(l)},{default:a(()=>[k(v(e.t("common.add")),1)]),_:2},1032,["onClick"]),[[j,["system:menu:add"]]]),N(t(c,{type:"link",color:"success",class:"mr-3",onClick:o=>e.handleUpdate(l)},{default:a(()=>[k(v(e.t("common.update")),1)]),_:2},1032,["onClick"]),[[j,["system:menu:update"]]]),t(i,{title:e.t("common.confirmDelete"),"ok-text":e.t("common.okText"),"cancel-text":e.t("common.cancelText"),onConfirm:o=>e.confirm(l),onCancel:e.cancel},{default:a(()=>[N(t(c,{type:"link",color:"error"},{default:a(()=>[k(v(e.t("common.delete")),1)]),_:1},512),[[j,["system:menu:delete"]]])]),_:2},1032,["title","ok-text","cancel-text","onConfirm","onCancel"])])]),_:1},8,["loading","columns","data-source"]),t(V,{width:"50%",title:e.drawerTitle,placement:"right",visible:e.open,"onUpdate:visible":n[12]||(n[12]=l=>e.open=l),maskClosable:!1,onClose:e.handleClose},{default:a(()=>[e.open?(p(),f(P,{key:0,ref:"formRef",model:e.formState,rules:e.rules,"label-col":e.labelCol,"wrapper-col":e.wrapperCol},{default:a(()=>[t(M,null,{default:a(()=>[t(s,{span:12},{default:a(()=>[t(u,{label:e.t("routes.menu.parentId"),name:"parentId"},{default:a(()=>[t(A,{ref:"treeRef",class:"!mt-[3px]",modelValue:e.formState.parentId,"onUpdate:modelValue":n[0]||(n[0]=l=>e.formState.parentId=l),normalizer:e.normalizer,placeholder:e.t("routes.menu.parentIdPlaceholder"),options:e.treeOptions,onSelect:e.handleTreeSelect},null,8,["modelValue","normalizer","placeholder","options","onSelect"])]),_:1},8,["label"])]),_:1}),t(s,{span:12},{default:a(()=>[t(u,{label:e.t("routes.menu.menuType"),name:"menuType"},{default:a(()=>[t(_,{value:e.formState.menuType,"onUpdate:value":n[1]||(n[1]=l=>e.formState.menuType=l),options:[{label:e.t("routes.menu.M"),value:"M"},{label:e.t("routes.menu.C"),value:"C"},{label:e.t("routes.menu.F"),value:"F"}]},null,8,["value","options"])]),_:1},8,["label"])]),_:1}),t(s,{span:12},{default:a(()=>[t(u,{label:e.t("routes.menu.title"),name:"title"},{default:a(()=>[t(O,{value:e.formState.title,"onUpdate:value":n[2]||(n[2]=l=>e.formState.title=l),placeholder:e.t("routes.menu.titlePlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),e.formState.menuType!=="F"?(p(),f(s,{key:0,span:12},{default:a(()=>[t(u,{label:e.t("routes.menu.icon"),name:"icon"},{default:a(()=>[t(E,{value:e.formState.icon,"onUpdate:value":n[3]||(n[3]=l=>e.formState.icon=l),placeholder:e.t("routes.menu.iconPlaceholder"),onChange:e.handleIconChange},null,8,["value","placeholder","onChange"])]),_:1},8,["label"])]),_:1})):T("",!0),t(s,{span:12},{default:a(()=>[t(u,{label:e.t("routes.menu.orderNum"),name:"orderNum"},{default:a(()=>[t(R,{class:"!w-[100%]",value:e.formState.orderNum,"onUpdate:value":n[4]||(n[4]=l=>e.formState.orderNum=l),placeholder:e.t("routes.menu.orderNumPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),e.formState.menuType!=="F"?(p(),f(s,{key:1,span:12},{default:a(()=>[t(u,{label:e.t("routes.menu.path"),name:"path"},{default:a(()=>[t(O,{value:e.formState.path,"onUpdate:value":n[5]||(n[5]=l=>e.formState.path=l),placeholder:e.t("routes.menu.pathNumPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1})):T("",!0),e.formState.menuType==="C"||e.formState.menuType==="M"?(p(),f(s,{key:2,span:12},{default:a(()=>[t(u,{label:e.t("routes.menu.component"),name:"component"},{default:a(()=>[t(B,{placeholder:e.t("routes.menu.componentPlaceholder"),value:e.formState.component,"onUpdate:value":n[6]||(n[6]=l=>e.formState.component=l)},{default:a(()=>[(p(!0),z(G,null,J(e.dynamicComponents,l=>(p(),f(D,{key:l,value:l},{default:a(()=>[k(v(l),1)]),_:2},1032,["value"]))),128))]),_:1},8,["placeholder","value"])]),_:1},8,["label"])]),_:1})):T("",!0),e.formState.menuType==="F"?(p(),f(s,{key:3,span:12},{default:a(()=>[t(u,{label:e.t("routes.menu.perms"),name:"perms"},{default:a(()=>[t(O,{value:e.formState.perms,"onUpdate:value":n[7]||(n[7]=l=>e.formState.perms=l),placeholder:e.t("routes.menu.permsPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1})):T("",!0),e.formState.menuType!=="F"?(p(),f(s,{key:4,span:12},{default:a(()=>[t(u,{label:e.t("routes.menu.visible"),name:"visible"},{default:a(()=>[t(_,{value:e.formState.visible,"onUpdate:value":n[8]||(n[8]=l=>e.formState.visible=l),options:e.showOrHideOptions},null,8,["value","options"])]),_:1},8,["label"])]),_:1})):T("",!0),t(s,{span:12},{default:a(()=>[t(u,{label:e.t("routes.menu.status"),name:"status"},{default:a(()=>[t(_,{value:e.formState.status,"onUpdate:value":n[9]||(n[9]=l=>e.formState.status=l),options:e.disableOptions},null,8,["value","options"])]),_:1},8,["label"])]),_:1}),e.formState.menuType!=="F"?(p(),f(s,{key:5,span:12},{default:a(()=>[t(u,{label:e.t("routes.menu.keepAlive"),name:"keepAlive"},{default:a(()=>[t(_,{value:e.formState.keepAlive,"onUpdate:value":n[10]||(n[10]=l=>e.formState.keepAlive=l),options:[{label:e.t("routes.menu.cache"),value:1},{label:e.t("routes.menu.noCache"),value:0}]},null,8,["value","options"])]),_:1},8,["label"])]),_:1})):T("",!0),e.formState.menuType!=="F"?(p(),f(s,{key:6,span:12},{default:a(()=>[t(u,{label:e.t("routes.menu.isFrame"),name:"isFrame"},{default:a(()=>[t(_,{value:e.formState.isFrame,"onUpdate:value":n[11]||(n[11]=l=>e.formState.isFrame=l),options:[{label:e.t("routes.menu.yes"),value:"1"},{label:e.t("routes.menu.no"),value:"0"}]},null,8,["value","options"])]),_:1},8,["label"])]),_:1})):T("",!0),t(s,{span:24},{default:a(()=>[t(u,null,{default:a(()=>[t(c,{type:"primary",class:"mr-3",onClick:e.handleSubmit},{default:a(()=>[k(v(e.t("common.okText")),1)]),_:1},8,["onClick"]),t(c,{onClick:e.handleClose},{default:a(()=>[k(v(e.t("common.cancelText")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules","label-col","wrapper-col"])):T("",!0)]),_:1},8,["title","visible","onClose"])])}var st=H(Je,[["render",xe]]);export{st as default};
